{%extends "navbar.html"%}
{% load static %}
{%block content%}
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="{% static 'css/mosaic.css' %}"> 

</head>
<body>
    <div class="grid-container">
        {%for image in list_images%}
        <div class="grid-item" onclick="handleClick({{forloop.counter}})">
            <img src={%static image.name%}>
            <div class="image-name">{{image.title}}</div>
        </div>
        {%endfor%}   


    </div>
    {%for image in list_images%}
    <div class="card" id="card{{forloop.counter}}">{{image.details|safe}}</div>
    {%endfor%}
    
    <div class="mask" id ="mask0" onclick="handleClickMask()"></div>

    <script>
        var card_clicked =0;

        document.addEventListener('keydown', function(event) {
            if (event.keyCode === 27 && card_clicked==1) {
                handleClickMask();
            }
        });

        var currentCard=-1;
        function handleClick(imageNumber) {
            currentCard = imageNumber;
            card_clicked =1;
            var card = document.getElementById("card" + imageNumber);
            card.style.display = "block";
            card.style.animation = "drop 1s forwards";

            var mask = document.getElementById("mask0");
            mask.style.display = "block";
            mask.style.animation = "dropMASK 1s forwards";
            
            
            // make the blur progressively stronger
            var blur = 0;
            var blurInterval = setInterval(function() {
                blur++;
                //blur grid container
                var grid = document.getElementsByClassName("grid-container")[0];
                grid.style.filter = 'blur(' + blur + 'px)';
                if (blur === 5) clearInterval(blurInterval);
            }, 100);

            
        }
        function handleClickMask(){
            //unblur grid container
            card_clicked=0
            var grid = document.getElementsByClassName("grid-container")[0];
            grid.style.filter = 'blur(0px)';
            //hide mask
            var mask = document.getElementById("mask0");
            mask.style.animation = "monteMASK 1s forwards";
            //hide card
            var card = document.getElementById("card" + currentCard);
            card.style.animation = "monteCARD 1s forwards";
        }
    
    </script>
</body>
</html>

{%endblock content%}